webpackJsonp([11],{K85o:function(t,e){},zltl:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("TvJ3"),s=a("gmQn"),i=a("EuEE"),l=a("mw3O"),n=a.n(l),o={name:"perCapita",data:function(){return{search_per:{beginCalldate:new Date,endCalldate:new Date,corp:[],proj:[],size:10,page:1},list:{data:[],totalPage:0,totalCount:0},total:{sumleads:"",sumseats:"",sumpercapita:""},endDatePicker:this.processDate(),teamData:[],projData:[],isCorpContainAll:!0,isProjContainAll:!0}},created:function(){this.teamData=JSON.parse(localStorage.getItem("cropid")),this.projData=JSON.parse(localStorage.getItem("projid")),this.search_per.corp[0]=this.teamData[0].id,this.search_per.proj[0]=this.projData[0].id,this.getPercapitaData()},methods:{getSbeginTime:function(t){this.beginTime=t},getSendTime:function(t){this.endTime=t},processDate:function(){var t=this;return{disabledDate:function(e){if(t.search_per.beginCalldate)return new Date(t.search_per.beginCalldate).getTime()>=e.getTime()}}},getPercapitaData:function(){var t=this,e={beginCalldate:Object(i.a)(this.search_per.beginCalldate,"yyyyMMdd"),endCalldate:Object(i.a)(this.search_per.endCalldate,"yyyyMMdd"),corp:this.search_per.corp.join(","),proj:this.search_per.proj.join(","),page:this.search_per.page,size:this.search_per.size};return s.a.request({method:"post",url:"percapita",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:[function(t){return t=n.a.stringify(t)}],data:e}).then(function(e){t.list.data=e.data.list,t.list.totalCount=e.data.totalCount,t.list.totalPage=e.data.totalPage,t.total.sumleads=e.data.sumleads,t.total.sumseats=e.data.sumseats,t.total.sumpercapita=e.data.sumpercapita}).catch(function(t){console.log(t)})},search_data:function(){0!=this.search_per.corp.length?0!=this.search_per.proj.length?(this.search_per.page=1,this.getPercapitaData()):this.$message({message:"请选择品牌",type:"warning"}):this.$message({message:"请选择外呼团队",type:"warning"})},getTotal:function(t){var e=this,a=t.columns,r=t.data,s=[];return a.forEach(function(t,a){r.map(function(e){return Number(e[t.property])});"leads"===t.property?s[a]=e.total.sumleads:"seats"===t.property?s[a]=e.total.sumseats:"percapita"===t.property?s[a]=e.total.sumpercapita:s[a]="--"}),s},formatDate:function(t){var e=t.calldate.toString();return t.calldate=e.replace(/^(\d{4})(\d{2})(\d{2})$/,"$1-$2-$3")},changeStaff:function(t){"corp"==t?this.isCorpContainAll?(this.isCorpContainAll=!1,this.search_per.corp.splice(0,1)):(this.isCorpContainAll=this.search_per.corp.some(function(t){return 0===t}),this.isCorpContainAll?this.search_per.corp=[0]:this.search_per.corp.length==this.teamData.length-1&&(this.search_per.corp=[0],this.isCorpContainAll=!0)):"proj"==t&&(this.isProjContainAll?(this.isProjContainAll=!1,this.search_per.proj.splice(0,1)):(this.isProjContainAll=this.search_per.proj.some(function(t){return 0===t}),this.isProjContainAll?this.search_per.proj=[0]:this.search_per.proj.length==this.projData.length-1&&(this.search_per.proj=[0],this.isProjContainAll=!0)))},formatCorp:function(t){for(var e=0;e<this.teamData.length;e++)if(t.corp==this.teamData[e].id)return t.crop=this.teamData[e].memo},formatProj:function(t){var e=this.projData;e=e.slice(1);for(var a=0;a<e.length;a++)if(t.proj==e[a].id)return t.porj=e[a].memo},change_data:function(t,e){console.log("11111"),this.search_per.page=t,this.search_per.size=e,this.getPercapitaData()}},components:{"pager-table":r.a}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main quality"},[a("div",{staticClass:"main-search"},[a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[t._v("开始日期")]),t._v(" "),a("span",{staticClass:"item-right"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"开始日期"},on:{change:t.getSbeginTime},model:{value:t.search_per.beginCalldate,callback:function(e){t.$set(t.search_per,"beginCalldate",e)},expression:"search_per.beginCalldate"}})],1)]),t._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[t._v("结束日期")]),t._v(" "),a("span",{staticClass:"item-right"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"结束日期","picker-options":t.endDatePicker},on:{change:t.getSendTime},model:{value:t.search_per.endCalldate,callback:function(e){t.$set(t.search_per,"endCalldate",e)},expression:"search_per.endCalldate"}})],1)]),t._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[t._v("外呼团队")]),t._v(" "),a("span",{staticClass:"item-right"},[a("el-select",{attrs:{multiple:"","collapse-tags":""},on:{change:function(e){return t.changeStaff("corp")}},model:{value:t.search_per.corp,callback:function(e){t.$set(t.search_per,"corp",e)},expression:"search_per.corp"}},[t._l(t.teamData,function(e){return[a("el-option",{key:e.id,attrs:{label:e.memo,value:e.id}},[t._v(t._s(e.memo))])]})],2)],1)]),t._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[t._v("品牌")]),t._v(" "),a("span",{staticClass:"item-right"},[a("el-select",{attrs:{multiple:"","collapse-tags":""},on:{change:function(e){return t.changeStaff("proj")}},model:{value:t.search_per.proj,callback:function(e){t.$set(t.search_per,"proj",e)},expression:"search_per.proj"}},[t._l(t.projData,function(e){return[a("el-option",{key:e.id,attrs:{label:e.memo,value:e.id}},[t._v(t._s(e.memo))])]})],2)],1)]),t._v(" "),a("button",{staticClass:"btn-search",attrs:{type:"button"},on:{click:t.search_data}},[t._v("查询")])]),t._v(" "),a("div",{staticClass:"main-table"},[a("div",{staticClass:"table-msg"},[a("div",{staticClass:"msg-left"},[a("p",[t._v("查询符合上述条件的数据"),a("span",[t._v(t._s(t.list.totalCount))]),t._v("条")])])]),t._v(" "),a("el-table",{staticStyle:{"text-align":"center"},attrs:{data:t.list.data,border:"","show-summary":"","summary-method":t.getTotal}},[a("el-table-column",{attrs:{prop:"calldate",align:"center",formatter:t.formatDate,label:"时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"crop",align:"center",formatter:t.formatCorp,label:"外呼团队"}}),t._v(" "),a("el-table-column",{attrs:{prop:"porj",align:"center",formatter:t.formatProj,label:"品牌"}}),t._v(" "),a("el-table-column",{attrs:{prop:"leads",align:"center",label:"成单数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"seats",align:"center",label:"坐席数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"percapita",align:"center",label:"人均单量"}})],1),t._v(" "),a("pager-table",{attrs:{show_size:"true",cur:t.search_per.page,total_page:t.list.totalPage,total_count:t.list.totalCount},on:{change:t.change_data}})],1)])},staticRenderFns:[]};var p=a("VU/8")(o,c,!1,function(t){a("K85o")},null,null);e.default=p.exports}});
//# sourceMappingURL=11.c07133e79032b6a678a3.js.map