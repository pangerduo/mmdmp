webpackJsonp([11],{"1XnO":function(e,t){},Sxpd:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("EuEE"),s=a("TvJ3"),i=a("6vT6"),c=a("gmQn"),o=a("mw3O"),n=a.n(o),r={name:"detailReport",components:{popupBox:i.a,pageTable:s.a},data:function(){return{search_det:{cid:[],proj:[],umemo:"",modelname:"",modelvalue:"0",province:"",provincevalue:"0",city:"",cityvalue:"0",user:"",uservalue:"0",beginCallhour:"08",endCallhour:"22",beginCalldate:new Date,endCalldate:new Date,groupBy:"calldate,cid,umemo,prjid_local,modelname",size:10,page:1},list:{data:[],totalPage:0,totalCount:0},checked:{calldate:!0,callhour:!1,province:!1,city:!1,cid:!0,umemo:!0,prjid_local:!0,modelname:!0},total:{sumcallout:"",sumconnect:"",sumconnectrate:"",sumleads:"",sumleadsrate:""},popup_show:!1,isCorpContainAll:!0,isProjContainAll:!0,teamData:[],projData:[],modelData:[],provinceData:[],cityData:[],userData:[],endDatePicker:this.processDate(),dataType:[],dataId:""}},created:function(){this.teamData=JSON.parse(localStorage.getItem("cropid")),this.projData=JSON.parse(localStorage.getItem("projid")),this.modelData=JSON.parse(localStorage.getItem("model")),this.provinceData=JSON.parse(localStorage.getItem("province")),this.cityData=JSON.parse(localStorage.getItem("city")),this.userData=JSON.parse(localStorage.getItem("user")),this.search_det.cid[0]=this.teamData[0].id,this.search_det.proj[0]=this.projData[0].id,this.getSeatList()},methods:{search_detail:function(){null!=this.search_det.beginCalldate?null!=this.search_det.endCalldate?null!=this.search_det.beginCalldate&&null!=this.search_det.endCalldate&&this.search_det.beginCalldate.getTime()>this.search_det.endCalldate.getTime()?this.$message({message:"开始日期不能大于结束日期",type:"warning"}):0!=this.search_det.cid.length?0!=this.search_det.proj.length?(this.search_det.page=1,this.getSeatList()):this.$message({message:"请选择品牌",type:"warning"}):this.$message({message:"请选择外呼团队",type:"warning"}):this.$message({message:"请选择结束时间",type:"warning"}):this.$message({message:"请选择开始时间",type:"warning"})},getSbeginTime:function(e){this.search_det.beginCalldate=new Date(e)},getSendTime:function(e){this.search_det.endCalldate=new Date(e)},processDate:function(){var e=this;return{disabledDate:function(t){if(e.search_det.beginCalldate)return new Date(e.search_det.beginCalldate).getTime()>t.getTime()}}},changeStaff:function(e){"corp"==e?this.isCorpContainAll?(this.isCorpContainAll=!1,this.search_det.cid.splice(0,1)):(this.isCorpContainAll=this.search_det.cid.some(function(e){return 0===e}),this.isCorpContainAll?this.search_det.cid=[0]:this.search_det.cid.length==this.teamData.length-1&&(this.search_det.cid=[0],this.isCorpContainAll=!0)):"proj"==e&&(this.isProjContainAll?(this.isProjContainAll=!1,this.search_det.proj.splice(0,1)):(this.isProjContainAll=this.search_det.proj.some(function(e){return 0===e}),this.isProjContainAll?this.search_det.proj=[0]:this.search_det.proj.length==this.projData.length-1&&(this.search_det.proj=[0],this.isProjContainAll=!0)))},dialog_batch:function(e){"modelname"==e?(this.dataType=this.modelData,this.dataId="1"):"province"==e?(this.dataType=this.provinceData,this.dataId="2"):"city"==e?(this.dataType=this.cityData,this.dataId="3"):"user"==e&&(this.dataType=this.userData,this.dataId="4"),this.popup_show=!0},getSeatList:function(){var e=this,t={};return t.beginCalldate=Object(l.a)(this.search_det.beginCalldate,"yyyyMMdd"),t.endCalldate=Object(l.a)(this.search_det.endCalldate,"yyyyMMdd"),t.beginCallhour=this.search_det.beginCallhour,t.endCallhour=this.search_det.endCallhour,t.groupBy=this.search_det.groupBy,t.page=this.search_det.page,t.size=this.search_det.size,t.province=this.search_det.provincevalue,t.city=this.search_det.cityvalue,t.cid=this.search_det.cid.join(","),t.prjid_local=this.search_det.proj.join(","),t.uname=this.search_det.uservalue,t.modelname=this.search_det.modelvalue,c.a.request({method:"post",url:"detail ",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:[function(e){return e=n.a.stringify(e)}],data:t}).then(function(t){e.list.data=t.data.list,e.list.totalCount=t.data.totalCount,e.list.totalPage=t.data.totalPage,e.total.sumcallout=t.data.sumcallout,e.total.sumconnect=t.data.sumconnect,e.total.sumconnectrate=t.data.sumconnectrate,e.total.sumleads=t.data.sumleads,e.total.sumleadsrate=t.data.sumleadsrate}).catch(function(e){console.log(e)})},checkedChange:function(e,t){var a=this.search_det.groupBy.split(",");if(t){for(var l=[e],s=0;s<a.length;s++)-1==l.indexOf(a[s])&&l.push(a[s]);this.search_det.groupBy=l.join(",")}else{var i=a.indexOf(e);console.log(i),a.splice(i,1),0==a.length?this.search_det.groupBy="true":this.search_det.groupBy=a.join(",")}if(0!=a.length){this.search_det.groupBy=this.search_det.groupBy.replace(/,$/gi,""),this.getSeatList()}},save:function(){this.popup_show=!1,"1"==this.dataId?""!=this.$refs.getDataName.complete()[0]?(this.search_det.modelname=this.$refs.getDataName.complete()[0].join(","),this.search_det.modelvalue=this.$refs.getDataName.complete()[1].join(",")):(this.search_det.modelname="",this.search_det.modelvalue="0"):"2"==this.dataId?""!=this.$refs.getDataName.complete()[0]?(this.search_det.province=this.$refs.getDataName.complete()[0].join(","),this.search_det.provincevalue=this.$refs.getDataName.complete()[1].join(",")):(this.search_det.province="",this.search_det.provincevalue="0"):"3"==this.dataId?""!=this.$refs.getDataName.complete()[0]?(this.search_det.city=this.$refs.getDataName.complete()[0].join(","),this.search_det.cityvalue=this.$refs.getDataName.complete()[1].join(",")):(this.search_det.city="",this.search_det.cityvalue="0"):"4"==this.dataId&&(""!=this.$refs.getDataName.complete()[0]?(this.search_det.umemo=this.$refs.getDataName.complete()[0].join(","),this.search_det.uservalue=this.$refs.getDataName.complete()[1].join(",")):(this.search_det.umemo="",this.search_det.uservalue="0"))},getTotal:function(e){var t=this,a=e.columns,l=e.data,s=[];return a.forEach(function(e,a){l.map(function(t){return Number(t[e.property])});"callout"===e.property?s[a]=t.total.sumcallout:"connect"===e.property?s[a]=t.total.sumconnect:"connectRate"===e.property?s[a]=t.total.sumconnectrate+"%":"leads"===e.property?s[a]=t.total.sumleads:"leadsRate"===e.property?s[a]=t.total.sumleadsrate+"%":s[a]="--"}),s},formatDate:function(e){if(e.calldate){var t=e.calldate.toString();return e.calldate=t.replace(/^(\d{4})(\d{2})(\d{2})$/,"$1-$2-$3")}},formatCorp:function(e){for(var t=0;t<this.teamData.length;t++)if(e.cid==this.teamData[t].id)return e.crop=this.teamData[t].memo},formatProj:function(e){var t=this.projData;t=t.slice(1);for(var a=0;a<t.length;a++)if(e.prjid_local==t[a].id)return e.porj=t[a].memo},formatModel:function(e){for(var t=0;t<this.modelData.length;t++)if(e.modelname==this.modelData[t].id)return e.modelName=this.modelData[t].memo},formatProvince:function(e){for(var t=0;t<this.provinceData.length;t++)if(e.province==this.provinceData[t].id)return e.provincename=this.provinceData[t].memo},formatCity:function(e){for(var t=0;t<this.cityData.length;t++)if(e.city==this.cityData[t].id)return e.cityname=this.cityData[t].memo},change_data:function(e,t){this.search_det.page=e,this.search_det.size=t,this.getSeatList()}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main quality"},[a("div",{staticClass:"main-search"},[a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("开始日期")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:e.getSbeginTime},model:{value:e.search_det.beginCalldate,callback:function(t){e.$set(e.search_det,"beginCalldate",t)},expression:"search_det.beginCalldate"}})],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("结束日期")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":e.endDatePicker},on:{change:e.getSendTime},model:{value:e.search_det.endCalldate,callback:function(t){e.$set(e.search_det,"endCalldate",t)},expression:"search_det.endCalldate"}})],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("开始时段")]),e._v(" "),a("el-select",{model:{value:e.search_det.beginCallhour,callback:function(t){e.$set(e.search_det,"beginCallhour",t)},expression:"search_det.beginCallhour"}},[a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"08",value:"08"}},[e._v("08")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"09",value:"09"}},[e._v("09")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"10",value:"10"}},[e._v("10")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"11",value:"11"}},[e._v("11")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"12",value:"12"}},[e._v("12")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"13",value:"13"}},[e._v("13")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"14",value:"14"}},[e._v("14")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"15",value:"15"}},[e._v("15")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"16",value:"16"}},[e._v("16")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"17",value:"17"}},[e._v("17")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"18",value:"18"}},[e._v("18")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"19",value:"19"}},[e._v("19")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"20",value:"20"}},[e._v("20")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"21",value:"21"}},[e._v("21")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"22",value:"22"}},[e._v("22")])],1)],1),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("结束时段")]),e._v(" "),a("el-select",{model:{value:e.search_det.endCallhour,callback:function(t){e.$set(e.search_det,"endCallhour",t)},expression:"search_det.endCallhour"}},[a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"08",value:"08"}},[e._v("08")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"09",value:"09"}},[e._v("09")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"10",value:"10"}},[e._v("10")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"11",value:"11"}},[e._v("11")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"12",value:"12"}},[e._v("12")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"13",value:"13"}},[e._v("13")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"14",value:"14"}},[e._v("14")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"15",value:"15"}},[e._v("15")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"16",value:"16"}},[e._v("16")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"17",value:"17"}},[e._v("17")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"18",value:"18"}},[e._v("18")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"19",value:"19"}},[e._v("19")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"20",value:"20"}},[e._v("20")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"21",value:"21"}},[e._v("21")]),e._v(" "),a("el-option",{staticStyle:{"padding-left":"15px"},attrs:{label:"22",value:"22"}},[e._v("22")])],1)],1),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("外呼团队")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-select",{attrs:{multiple:"","collapse-tags":""},on:{change:function(t){return e.changeStaff("corp")}},model:{value:e.search_det.cid,callback:function(t){e.$set(e.search_det,"cid",t)},expression:"search_det.cid"}},[e._l(e.teamData,function(t){return[a("el-option",{key:t.id,attrs:{label:t.memo,value:t.id}},[e._v(e._s(t.memo))])]})],2)],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("品牌")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-select",{attrs:{multiple:"","collapse-tags":""},on:{change:function(t){return e.changeStaff("proj")}},model:{value:e.search_det.proj,callback:function(t){e.$set(e.search_det,"proj",t)},expression:"search_det.proj"}},[e._l(e.projData,function(t){return[a("el-option",{key:t.id,attrs:{label:t.memo,value:t.id}},[e._v(e._s(t.memo))])]})],2)],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("省份")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-input",{attrs:{placeholder:"点击选择"},nativeOn:{click:function(t){return e.dialog_batch("province")}},model:{value:e.search_det.province,callback:function(t){e.$set(e.search_det,"province",t)},expression:"search_det.province"}})],1)]),e._v(" "),a("div",{staticClass:"search-item "},[a("span",{staticClass:"item-left"},[e._v("城市")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-input",{attrs:{placeholder:"点击选择",readonly:""},nativeOn:{click:function(t){return e.dialog_batch("city")}},model:{value:e.search_det.city,callback:function(t){e.$set(e.search_det,"city",t)},expression:"search_det.city"}})],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("数据批次")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-input",{staticStyle:{cursor:"pointer"},attrs:{placeholder:"点击选择",readonly:""},nativeOn:{click:function(t){return e.dialog_batch("modelname")}},model:{value:e.search_det.modelname,callback:function(t){e.$set(e.search_det,"modelname",t)},expression:"search_det.modelname"}})],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("坐席姓名")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-input",{attrs:{placeholder:"点击选择",readonly:""},nativeOn:{click:function(t){return e.dialog_batch("user")}},model:{value:e.search_det.umemo,callback:function(t){e.$set(e.search_det,"umemo",t)},expression:"search_det.umemo"}})],1)]),e._v(" "),a("div",{staticClass:"search-item",staticStyle:{"margin-top":"10px"}},[a("span",{staticClass:"item-left"},[e._v("分组条件")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-checkbox",{attrs:{label:"日期",name:"test"},on:{change:function(t){return e.checkedChange("calldate",e.checked.calldate)}},model:{value:e.checked.calldate,callback:function(t){e.$set(e.checked,"calldate",t)},expression:"checked.calldate"}}),e._v(" "),a("el-checkbox",{attrs:{label:"时段",name:"test"},on:{change:function(t){return e.checkedChange("callhour",e.checked.callhour)}},model:{value:e.checked.callhour,callback:function(t){e.$set(e.checked,"callhour",t)},expression:"checked.callhour"}}),e._v(" "),a("el-checkbox",{attrs:{label:"省份",name:"test"},on:{change:function(t){return e.checkedChange("province",e.checked.province)}},model:{value:e.checked.province,callback:function(t){e.$set(e.checked,"province",t)},expression:"checked.province"}}),e._v(" "),a("el-checkbox",{attrs:{label:"城市",name:"test"},on:{change:function(t){return e.checkedChange("city",e.checked.city)}},model:{value:e.checked.city,callback:function(t){e.$set(e.checked,"city",t)},expression:"checked.city"}}),e._v(" "),a("el-checkbox",{attrs:{label:"外呼团队",name:"test"},on:{change:function(t){return e.checkedChange("cid",e.checked.cid)}},model:{value:e.checked.cid,callback:function(t){e.$set(e.checked,"cid",t)},expression:"checked.cid"}}),e._v(" "),a("el-checkbox",{attrs:{label:"坐席",name:"test"},on:{change:function(t){return e.checkedChange("umemo",e.checked.umemo)}},model:{value:e.checked.umemo,callback:function(t){e.$set(e.checked,"umemo",t)},expression:"checked.umemo"}}),e._v(" "),a("el-checkbox",{attrs:{label:"品牌",name:"test"},on:{change:function(t){return e.checkedChange("prjid_local",e.checked.prjid_local)}},model:{value:e.checked.prjid_local,callback:function(t){e.$set(e.checked,"prjid_local",t)},expression:"checked.prjid_local"}}),e._v(" "),a("el-checkbox",{attrs:{label:"数据批次",name:"test"},on:{change:function(t){return e.checkedChange("modelname",e.checked.modelname)}},model:{value:e.checked.modelname,callback:function(t){e.$set(e.checked,"modelname",t)},expression:"checked.modelname"}})],1)]),e._v(" "),a("button",{staticClass:"btn-search",attrs:{type:"button"},on:{click:e.search_detail}},[e._v("查询")])]),e._v(" "),a("div",{staticClass:"main-table"},[a("div",{staticClass:"table-msg"},[a("div",{staticClass:"msg-left"},[a("p",[e._v("查询符合上述条件的数据"),a("span",[e._v(e._s(e.list.totalCount))]),e._v("条")])])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list.data,border:"","show-summary":"","summary-method":e.getTotal,"default-sort":{prop:"date",order:"descending"}}},[e.checked.calldate?a("el-table-column",{attrs:{prop:"calldate",align:"center",formatter:e.formatDate,width:"100",label:"日期"}}):e._e(),e._v(" "),e.checked.callhour?a("el-table-column",{attrs:{prop:"callhour",align:"center",label:"时段"}}):e._e(),e._v(" "),e.checked.cid?a("el-table-column",{attrs:{prop:"cid",align:"center",label:"外呼团队",formatter:e.formatCorp}}):e._e(),e._v(" "),e.checked.umemo?a("el-table-column",{attrs:{prop:"umemo",align:"center",label:"坐席"}}):e._e(),e._v(" "),e.checked.prjid_local?a("el-table-column",{attrs:{prop:"prjid_local",align:"center",formatter:e.formatProj,label:"品牌"}}):e._e(),e._v(" "),e.checked.modelname?a("el-table-column",{attrs:{prop:"modelName",formatter:e.formatModel,align:"center",label:"数据批次"}}):e._e(),e._v(" "),e.checked.province?a("el-table-column",{attrs:{prop:"provincename",align:"center",formatter:e.formatProvince,label:"省份"}}):e._e(),e._v(" "),e.checked.city?a("el-table-column",{attrs:{prop:"cityname",align:"center",formatter:e.formatCity,label:"城市"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"callout",align:"center",sortable:"",label:"外呼数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"connect",align:"center",sortable:"",label:"接通数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"connectRate",align:"center",sortable:"",label:"接通率"},scopedSlots:e._u([{key:"default",fn:function(t){return[0!=t.row.connectRate?a("p",{attrs:{type:"text",size:"small"}},[e._v(e._s(t.row.connectRate)+"%")]):a("p",{attrs:{type:"text",size:"small"}},[e._v(e._s(t.row.connectRate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"leads",align:"center",label:"成功数",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"leadsRate",align:"center",label:"成功率",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[0!=t.row.leadsRate?a("p",{attrs:{type:"text",size:"small"}},[e._v(e._s(t.row.leadsRate)+"%")]):a("p",{attrs:{type:"text",size:"small"}},[e._v(e._s(t.row.leadsRate))])]}}])})],1),e._v(" "),a("page-table",{attrs:{show_size:"true",cur:e.search_det.page,total_page:e.list.totalPage,total_count:e.list.totalCount},on:{change:e.change_data}})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.popup_show},on:{"update:visible":function(t){e.popup_show=t}}},[a("popup-box",{ref:"getDataName",attrs:{dataList:e.dataType,dataId:e.dataId}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.popup_show=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(r,d,!1,function(e){a("1XnO")},"data-v-690cf8f8",null);t.default=h.exports}});
//# sourceMappingURL=11.daf3f6e69ac3fdc703f6.js.map