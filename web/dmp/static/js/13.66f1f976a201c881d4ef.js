webpackJsonp([13],{"6iAP":function(t,e){},KIq2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("TvJ3"),l=a("EuEE"),s=(a("3UNf"),a("gmQn")),n=a("mw3O"),d=a.n(n),o={name:"brand-collision",components:{pageTable:i.a},data:function(){return{dateline:Object(l.a)(new Date,"yyyy-MM-dd"),dateformat:Object(l.a)(new Date,"yyyyMMdd"),list:{data:[],totalPage:0,totalCount:0},fileList:[],filedata:[],fileform:{prjid_local:""},dialog_add:!1,proj_num:1,proj_list:[{value:1}],delList:[],dialog_delete:!1,del:{state:!1,allState:!0},deleteIds:[],btn:!0,size:20,page:1}},created:function(){this.getInitialList();for(var t=0;t<this.list.data.length;t++)this.getupload(this.list.data[t].id,t);var e=new Date,a=e.getFullYear()+"-"+(1*e.getMonth()+1)+"-"+e.getDate()+" 23:00",i=e.getFullYear()+"-"+(1*e.getMonth()+1)+"-"+(1*e.getDate()+1)+" 1:00";new Date(a)>=e>=new Date(i)?this.btn=!1:this.btn=!0},methods:{getInitialList:function(){var t=this;this.delList=[];var e={size:this.size,page:this.page};return s.a.request({method:"get",url:"hit/all",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},params:e}).then(function(e){for(var a=0;a<e.data.list.length;a++)t.$set(e.data.list[a],"checked",!1);t.list.data=e.data.list,t.list.totalCount=e.data.totalCount,t.list.totalPage=e.data.totalPage}).catch(function(t){console.log(t)})},download:function(t,e){var i={prjid_local:t};return s.a.request({method:"post",url:"/hit/download",responseType:"arraybuffer",transformRequest:[function(t){return t=d.a.stringify(t)}],data:i}).then(function(i){var l=a("3UNf");l(i,"30"==t?"下载"+e+".csv":"下载"+e+".xlsx")}).catch(function(t){console.log(t)})},uploadUrl:function(t){return"http://39.100.61.222/hit/upload?prjid_local="+t+"&file="},uploadSuccess:function(t,e,a){"200"==t.code?this.$message.success("导入成功"):this.$message.success("导入失败")},beforeAvatarUpload:function(t){var e="xlsx"===t.name.split(".")[1],a="csv"===t.name.split(".")[1];t.size;return e||a||alert("上传模板只能是 xlsx、csv 格式!"),e||a},prjidIds:function(t){this.fileform.prjid_local=t},addproj:function(){this.dialog_add=!0},addprojselect:function(){this.proj_list.push({value:1})},save:function(){var t=this;return s.a.request({method:"post",url:"hit/delete",data:{ids:this.deleteIds.join(",")}}).then(function(e){if("200"==e.code){for(var a in t.delList){var i=t.list.data.indexOf(t.delList[a]);i>-1&&t.list.data.splice(i,1)}t.deletetype=!1,t.dialog_delete=!1}}).catch(function(t){console.log(t)})},batchRemove:function(){this.del.state=!0,this.del.allState=!1},cancel:function(){this.del.state=!1,this.del.allState=!0},delArr:function(){this.delList.length<=0?this.$message.info("请选择您要删除的文件"):this.dialog_delete=!0},changedel:function(t,e,a){if(t)this.deleteIds.push(e),this.delList.push(a);else{var i=this.deleteIds.indexOf(e),l=this.delList.indexOf(a);i>-1&&this.deleteIds.splice(i,1),l>-1&&this.delList.splice(l,1)}},change_data:function(t,e){this.list.page=t,this.list.size=e,this.getInitialList()}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main rule-group"},[a("div",{staticClass:"main-table"},[a("div",{staticStyle:{border:"1px solid #ccc"}},[a("div",{staticClass:"table-msg"},[a("div",{staticClass:"msg-left"},[a("p",[t._v(t._s(t.dateline))])]),t._v(" "),t._m(0),t._v(" "),a("div",{staticClass:"msg-right"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.del.allState,expression:"del.allState"}],staticClass:"btn-small",on:{click:t.batchRemove}},[t._v("批量删除")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],staticClass:"btn-small",on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],staticClass:"btn-small",staticStyle:{"background-color":"#007bc4",color:"#fff"},on:{click:t.delArr}},[t._v("删除")])],1)]),t._v(" "),a("div",{staticClass:"table_container"},[a("div",[a("ul",[a("li",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],staticStyle:{width:"5%",height:"20px"}}),t._v(" "),a("li",{staticStyle:{width:"8%"}},[t._v("序号")]),t._v(" "),a("li",{staticStyle:{width:"10%"}},[t._v("品牌")]),t._v(" "),a("li",{staticStyle:{width:"26%"}},[t._v("可下载文件名")]),t._v(" "),a("li",{staticStyle:{width:"13%"}},[t._v("数据条数")]),t._v(" "),a("li",{staticStyle:{width:"20%"}},[t._v("最近更新时间")]),t._v(" "),a("li",{staticStyle:{width:"18%"}})]),t._v(" "),t._m(1)]),t._v(" "),a("div",{staticClass:"table_container"},t._l(t.list.data,function(e,i){return a("div",[a("ul",[a("li",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],staticStyle:{width:"5%"}},[a("el-checkbox",{attrs:{name:"list"},on:{change:function(a){return t.changedel(a,e.id,e)}},model:{value:e.checked,callback:function(a){t.$set(e,"checked",a)},expression:"item.checked"}})],1),t._v(" "),a("li",{staticStyle:{width:"8%"}},[t._v(t._s(1*i+1))]),t._v(" "),a("li",{staticStyle:{width:"10%"}},[t._v(t._s(e.name))]),t._v(" "),a("li",{staticStyle:{width:"26%"}},[t._v(t._s(e.name)+"_"+t._s(t.dateformat))]),t._v(" "),a("li",{staticStyle:{width:"13%"}},[t._v(t._s(e.number))]),t._v(" "),a("li",{staticStyle:{width:"20%"}},[t._v(t._s(t.dateline))]),t._v(" "),a("li",{staticStyle:{width:"18%"}},[a("el-button",{staticClass:"btn-small",attrs:{type:"button",disabled:!t.btn},on:{click:function(a){return t.download(e.id,e.name+"_"+t.dateformat)}}},[t._v("下载")])],1)]),t._v(" "),a("ul",[a("li",{staticStyle:{width:"24%"}},[t._v(t._s(e.filename_name))]),t._v(" "),a("li",{staticStyle:{width:"14%"}},[0==e.status?a("span",[t._v("上传中")]):1==e.status?a("span",[t._v("已上传")]):t._e()]),t._v(" "),a("li",{staticStyle:{width:"14%"}},[t._v(t._s(e.num))]),t._v(" "),a("li",{staticStyle:{width:"30%"}},[t._v(t._s(e.update_time))]),t._v(" "),a("li",{staticStyle:{width:"17%"}},[a("el-upload",{ref:"upload",refInFor:!0,staticClass:"upload-demo",attrs:{action:t.uploadUrl(e.id),"show-file-list":!1,"file-list":t.fileList,"auto-upload":!0,data:t.fileform,"before-upload":t.beforeAvatarUpload,"on-success":t.uploadSuccess}},[a("el-button",{staticClass:"btn-small",attrs:{type:"button",disabled:!t.btn},on:{click:function(a){return t.prjidIds(e.id)}}},[t._v("导入文件")])],1)],1)])])}),0)])]),t._v(" "),a("page-table",{attrs:{show_size:"true",cur:t.page,total_page:t.list.totalPage,total_count:t.list.totalCount},on:{change:t.change_data}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialog_delete,width:"35%",title:"删除确认"},on:{"update:visible":function(e){t.dialog_delete=e}}},[a("p",{staticStyle:{"text-align":"center"}},[t._v("是否确认删除"),t._l(t.delList,function(e,i){return a("span",[t._v(t._s(e.name)),i!=t.delList.length-1?a("em",[t._v("、")]):t._e()])}),t._v("?")],2),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialog_delete=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"msg-center"},[e("p",[this._v("说明：所有用于撞库数据需当天下载，当天上传，否则数据失效，按钮生效时间为每天01:00-23:00，当日23:00至次日1:00按钮不可用")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",{staticStyle:{width:"24%"}},[t._v("已上传文件名")]),t._v(" "),a("li",{staticStyle:{width:"14%"}},[t._v("上传状态")]),t._v(" "),a("li",{staticStyle:{width:"14%"}},[t._v("数据条数")]),t._v(" "),a("li",{staticStyle:{width:"30%"}},[t._v("最近更新时间")]),t._v(" "),a("li",{staticStyle:{width:"17%"}})])}]};var r=a("VU/8")(o,c,!1,function(t){a("6iAP")},"data-v-4620c3b4",null);e.default=r.exports}});
//# sourceMappingURL=13.66f1f976a201c881d4ef.js.map