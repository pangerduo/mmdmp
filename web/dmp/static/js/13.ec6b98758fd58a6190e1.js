webpackJsonp([13],{MbRF:function(e,t){},zltl:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("TvJ3"),r=a("gmQn"),l=a("EuEE"),i=a("mw3O"),n=a.n(i),o={name:"perCapita",data:function(){return{search_per:{beginCalldate:new Date,endCalldate:new Date,corp:[],proj:[],size:10,page:1},list:{data:[],totalPage:0,totalCount:0},total:{sumleads:"",sumseats:"",sumpercapita:""},endDatePicker:this.processDate(),teamData:[],projData:[],isCorpContainAll:!0,isProjContainAll:!0}},created:function(){this.teamData=JSON.parse(localStorage.getItem("cropid")),this.projData=JSON.parse(localStorage.getItem("projid")),this.search_per.corp[0]=this.teamData[0].id,this.search_per.proj[0]=this.projData[0].id,this.getPercapitaData()},methods:{getSbeginTime:function(e){this.search_per.beginCalldate=new Date(e)},getSendTime:function(e){this.search_per.endCalldate=new Date(e)},processDate:function(){var e=this;return{disabledDate:function(t){if(e.search_per.beginCalldate)return new Date(e.search_per.beginCalldate).getTime()-864e5>=t.getTime()}}},cellStyle:function(e){if("0"==e.rowIndex)return"color:red"},getPercapitaData:function(){var e=this,t={beginCalldate:Object(l.a)(this.search_per.beginCalldate,"yyyyMMdd"),endCalldate:Object(l.a)(this.search_per.endCalldate,"yyyyMMdd"),corp:this.search_per.corp.join(","),proj:this.search_per.proj.join(","),page:this.search_per.page,size:this.search_per.size};return r.a.request({method:"post",url:"percapita",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:[function(e){return e=n.a.stringify(e)}],data:t}).then(function(t){e.list.data=t.data.list,e.list.totalCount=t.data.totalCount,e.list.totalPage=t.data.totalPage;var a={calldate:"--",crop:"--",porj:"--",leads:t.data.sumleads,seats:t.data.sumseats,percapita:t.data.sumpercapita};e.list.data.unshift(a),e.total.sumleads=t.data.sumleads,e.total.sumseats=t.data.sumseats,e.total.sumpercapita=t.data.sumpercapita}).catch(function(e){console.log(e)})},search_data:function(){null!=this.search_per.beginCalldate?null!=this.search_per.endCalldate?(console.log(this.search_per.beginCalldate),null!=this.search_per.beginCalldate&&null!=this.search_per.endCalldate&&this.search_per.beginCalldate.getTime()>this.search_per.endCalldate.getTime()?this.$message({message:"开始日期不能大于结束日期",type:"warning"}):0!=this.search_per.corp.length?0!=this.search_per.proj.length?(this.search_per.page=1,this.getPercapitaData()):this.$message({message:"请选择品牌",type:"warning"}):this.$message({message:"请选择外呼团队",type:"warning"})):this.$message({message:"请选择结束时间",type:"warning"}):this.$message({message:"请选择开始时间",type:"warning"})},getTotal:function(e){var t=this,a=e.columns,s=e.data,r=[];return a.forEach(function(e,a){s.map(function(t){return Number(t[e.property])});"leads"===e.property?r[a]=t.total.sumleads:"seats"===e.property?r[a]=t.total.sumseats:"percapita"===e.property?r[a]=t.total.sumpercapita:r[a]="--"}),r},formatDate:function(e){var t=e.calldate.toString();return e.calldate=t.replace(/^(\d{4})(\d{2})(\d{2})$/,"$1-$2-$3")},changeStaff:function(e){"corp"==e?this.isCorpContainAll?(this.isCorpContainAll=!1,this.search_per.corp.splice(0,1)):(this.isCorpContainAll=this.search_per.corp.some(function(e){return 0===e}),this.isCorpContainAll?this.search_per.corp=[0]:this.search_per.corp.length==this.teamData.length-1&&(this.search_per.corp=[0],this.isCorpContainAll=!0)):"proj"==e&&(this.isProjContainAll?(this.isProjContainAll=!1,this.search_per.proj.splice(0,1)):(this.isProjContainAll=this.search_per.proj.some(function(e){return 0===e}),this.isProjContainAll?this.search_per.proj=[0]:this.search_per.proj.length==this.projData.length-1&&(this.search_per.proj=[0],this.isProjContainAll=!0)))},formatCorp:function(e){if(void 0==e.corp)return e.crop="--";for(var t=0;t<this.teamData.length;t++)if(e.corp==this.teamData[t].id)return e.crop=this.teamData[t].memo},formatProj:function(e){console.log(e.proj);var t=this.projData;if(t=t.slice(1),void 0==e.proj)return e.porj="--";for(var a=0;a<t.length;a++)if(e.proj==t[a].id)return e.porj=t[a].memo},change_data:function(e,t){console.log("11111"),this.search_per.page=e,this.search_per.size=t,this.getPercapitaData()}},components:{"pager-table":s.a}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main quality"},[a("div",{staticClass:"main-search"},[a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("开始日期")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"开始日期"},on:{change:e.getSbeginTime},model:{value:e.search_per.beginCalldate,callback:function(t){e.$set(e.search_per,"beginCalldate",t)},expression:"search_per.beginCalldate"}})],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("结束日期")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"结束日期","picker-options":e.endDatePicker},on:{change:e.getSendTime},model:{value:e.search_per.endCalldate,callback:function(t){e.$set(e.search_per,"endCalldate",t)},expression:"search_per.endCalldate"}})],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("外呼团队")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-select",{attrs:{multiple:"","collapse-tags":""},on:{change:function(t){return e.changeStaff("corp")}},model:{value:e.search_per.corp,callback:function(t){e.$set(e.search_per,"corp",t)},expression:"search_per.corp"}},[e._l(e.teamData,function(t){return[a("el-option",{key:t.id,attrs:{label:t.memo,value:t.id}},[e._v(e._s(t.memo))])]})],2)],1)]),e._v(" "),a("div",{staticClass:"search-item"},[a("span",{staticClass:"item-left"},[e._v("品牌")]),e._v(" "),a("span",{staticClass:"item-right"},[a("el-select",{attrs:{multiple:"","collapse-tags":""},on:{change:function(t){return e.changeStaff("proj")}},model:{value:e.search_per.proj,callback:function(t){e.$set(e.search_per,"proj",t)},expression:"search_per.proj"}},[e._l(e.projData,function(t){return[a("el-option",{key:t.id,attrs:{label:t.memo,value:t.id}},[e._v(e._s(t.memo))])]})],2)],1)]),e._v(" "),a("button",{staticClass:"btn-search",attrs:{type:"button"},on:{click:e.search_data}},[e._v("查询")])]),e._v(" "),a("div",{staticClass:"main-table"},[a("div",{staticClass:"table-msg"},[a("div",{staticClass:"msg-left"},[a("p",[e._v("查询符合上述条件的数据"),a("span",[e._v(e._s(e.list.totalCount))]),e._v("条")])])]),e._v(" "),a("el-table",{staticStyle:{"text-align":"center"},attrs:{data:e.list.data,border:"","cell-style":e.cellStyle}},[a("el-table-column",{attrs:{prop:"calldate",align:"center",formatter:e.formatDate,label:"时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"crop",align:"center",formatter:e.formatCorp,label:"外呼团队"}}),e._v(" "),a("el-table-column",{attrs:{prop:"porj",align:"center",formatter:e.formatProj,label:"品牌"}}),e._v(" "),a("el-table-column",{attrs:{prop:"leads",align:"center",label:"成单数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"seats",align:"center",label:"坐席数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"percapita",align:"center",label:"人均单量"}})],1),e._v(" "),a("pager-table",{attrs:{show_size:"true",cur:e.search_per.page,total_page:e.list.totalPage,total_count:e.list.totalCount},on:{change:e.change_data}})],1)])},staticRenderFns:[]};var p=a("VU/8")(o,c,!1,function(e){a("MbRF")},null,null);t.default=p.exports}});
//# sourceMappingURL=13.ec6b98758fd58a6190e1.js.map