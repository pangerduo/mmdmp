webpackJsonp([4],{"6VjT":function(t,a){},Cdx3:function(t,a,e){var l=e("sB3e"),i=e("lktj");e("uqUo")("keys",function(){return function(t){return i(l(t))}})},JeKj:function(t,a){},JngW:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l=e("fZjL"),i=e.n(l),s=e("TvJ3"),o=e("gmQn"),d=(e("EuEE"),e("mw3O"),e("7+uW")),n={name:"data-alignment",components:{pageTable:s.a},data:function(){return{search:{size:10,page:1},list:{data:[],totalCount:0,totalPage:0},del:{datas:{},state:!1,allState:!0},area:[],modelData2:[],modelData:[],addlist:[],proj:"",datanum:3,proj_num:1,dialog_add:!1,projData:[],hleadsrate:"",hcallout:"",mid:[],prjid_local:"",delarr:[]}},created:function(){this.modelData=JSON.parse(localStorage.getItem("model")),this.projData=JSON.parse(localStorage.getItem("projid")),this.proj=this.projData[0].id,this.modelData2=JSON.parse(localStorage.getItem("curl")),this.getInitialList()},methods:{getInitialList:function(){var t=this;this.del.state=!1,this.del.allState=!0,this.delarr=[];var a={prjid_local:this.proj,size:this.search.size,page:this.search.page};return o.a.request({method:"get",url:"filter/all",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},params:a}).then(function(a){console.log(a.data.list),t.list.data=a.data.list;for(var e=0;e<t.list.data.length;e++){d.default.set(t.list.data[e],"models_id",!1);for(var l=0;l<t.list.data[e].mdata.length;l++)d.default.set(t.list.data[e].mdata[l],"models_mid",!1);for(var i=0;i<t.projData.length;i++)t.projData[i].id===t.list.data[e].prjid_local&&(d.default.set(t.list.data[e],"prjid_name"),t.list.data[e].prjid_name=t.projData[i].memo)}console.log(t.list.data),t.list.totalCount=a.data.totalCount,t.list.totalPage=a.data.totalPage}).catch(function(t){console.log(t)})},adjust:function(t){t.adjust_type?t.adjust_type=!1:t.adjust_type=!0},addproj:function(t){var a=this;return this.dialog_add=!0,this.prjid_local=t.prjid_local,o.a.request({method:"get",url:"area",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},params:{prjid_local:t.prjid_local}}).then(function(e){if(0===e.data.model.length)a.area=a.modelData;else{a.area=[];for(var l=0;l<e.data.model.length;l++)i()(a.modelData2).map(function(t,i){e.data.model[l]==t&&a.area.push({memo:a.modelData2[t],id:e.data.model[l]})})}return a.addlist=[],o.a.request({method:"get",url:"count",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},params:{prjid_local:t.prjid_local,mid:a.area[0].id}}).then(function(t){a.hleadsrate=t.data[0].hleadsrate,a.hcallout=t.data[0].hcallout;var e={mid:a.area[0].id,leads_rate:t.data[0].hleadsrate,hcallout:t.data[0].hcallout};a.addlist.push(e)}).catch(function(t){console.log(t)})}).catch(function(t){console.log(t)})},getmodel:function(t){var a={mid:this.area[0].id,leads_rate:this.hleadsrate,hcallout:this.hcallout};this.addlist.push(a)},addprojselect:function(){this.getmodel()},dellist:function(t){this.addlist.splice(t,1)},save:function(){for(var t=this,a=[],e=0;e<this.addlist.length;e++)a.push(this.addlist[e].mid);return a=a.toString(),o.a.request({method:"post",url:"filter/add",data:{prjid_local:this.prjid_local,mid:a}}).then(function(a){t.$message.success("添加成功"),t.dialog_add=!1,t.getInitialList(),console.log(a)}).catch(function(a){console.log(a),t.$message.error("添加失败")})},saveproj:function(t){var a=this,e=[];for(var l in t.mdata){var i={};i.mid=t.mdata[l].mid,i.rank=t.mdata[l].rank,e.push(i)}var s={prjid_local:t.prjid_local,mdata:e};return o.a.request({method:"post",url:"filter/update",data:s}).then(function(t){"200"==t.code?(a.$message.success("保存成功"),a.getInitialList()):a.$message.error("保存失败")}).catch(function(t){console.log(t)})},change_data:function(t,a){this.search.page=t,this.search.size=a,this.del.state=!1,this.del.allState=!0,this.delarr=[],this.getInitialList()},changeSelect:function(){console.log(this.proj),this.getInitialList()},getMid:function(t,a){var e=this;return o.a.request({method:"get",url:"count",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},params:{prjid_local:this.prjid_local,mid:t}}).then(function(t){e.addlist[a].hcallout=t.data[0].hcallout,e.addlist[a].leads_rate=t.data[0].hleadsrate}).catch(function(t){console.log(t)})},getallModel:function(t,a,e){console.log(this.delarr);for(var l=0;l<this.list.data.length;l++){var i={};if(this.list.data[l].prjid_local==t.prjid_local){i.prjid_local=this.list.data[l].prjid_local,i.mid="";for(var s=0;s<this.list.data[l].mdata.length;s++)e?(d.default.set(this.list.data[l].mdata[s],"models_mid",e),i.mid+=this.list.data[l].mdata[s].mid+",",this.delarr[l]=i):(this.delarr.splice(l,1),console.log(this.delarr),d.default.set(this.list.data[l].mdata[s],"models_mid",!1));i.mid=i.mid.replace(/,$/gi,"")}}},getModels:function(t,a,e,l){for(var i=0;i<this.list.data.length;i++)if(this.list.data[i].prjid_local==a.prjid_local)if(d.default.set(this.list.data[i],"models_id",!1),d.default.set(this.list.data[i],"models_mid",!1),console.log(l),l)if(void 0==this.delarr[i]){var s={};s.prjid_local=a.prjid_local,s.mid=t.mid+"",this.delarr[i]=s}else this.delarr[i].mid+=","+t.mid,this.delarr[i].mid.split(",").length==this.list.data[i].mdata.length&&d.default.set(this.list.data[i],"models_id",l);else{for(var o=this.delarr[i].mid.split(","),n=0;n<o.length;n++)console.log(o[n]),o[n]==t.mid&&o.splice(n,1);0==o.length?this.delarr.splice(i,1):this.delarr[i].mid=o.join(","),console.log("......"),console.log(this.delarr)}},batchRemove:function(){this.del.state=!0,this.del.allState=!1},cancel:function(){this.del.state=!1,this.del.allState=!0},delArr:function(){var t=this;if(!(this.delarr.length<=0))return o.a.request({method:"post",url:"filter/delete",data:{mdata:this.delarr}}).then(function(a){"200"==a.code?(t.$message.success("删除成功"),t.getInitialList()):t.$message.error("删除失败")}).catch(function(t){console.log(t)});this.$message.info("请选择您要删除的文件")}},computed:{dragOptions:function(){return{animation:500,group:"description",ghostClass:"ghost"}}},watch:{isDragging:function(t){var a=this;t?this.delayedDragging=!0:this.$nextTick(function(){a.delayedDragging=!1})}}},r={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main filter"},[e("div",{staticClass:"main-table"},[e("div",{staticStyle:{border:"1px solid #ccc"}},[e("ul",[e("li",{staticStyle:{width:"10%"}},[e("el-select",{on:{change:t.changeSelect},model:{value:t.proj,callback:function(a){t.proj=a},expression:"proj"}},[t._l(t.projData,function(a){return[e("el-option",{key:a.id,attrs:{label:a.memo,value:a.id}},[t._v(t._s(a.memo))])]})],2)],1),t._v(" "),t._m(0),t._v(" "),e("li",{staticStyle:{width:"24%",margin:"10px","text-align":"right"}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.del.allState,expression:"del.allState"}],staticClass:"btn-small",on:{click:t.batchRemove}},[t._v("批量删除")]),t._v(" "),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],staticClass:"btn-small",on:{click:t.cancel}},[t._v("取消")]),t._v(" "),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],staticClass:"btn-small del-small",on:{click:t.delArr}},[t._v("删除")])],1)]),t._v(" "),t._l(t.list.data,function(a,l){return e("ul",{key:l},[e("li",{staticStyle:{width:"10%",height:"40px","line-height":"40px"}},[e("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],attrs:{name:"model"},on:{change:function(e){return t.getallModel(a,l,e)}},model:{value:a.models_id,callback:function(e){t.$set(a,"models_id",e)},expression:"items.models_id"}}),e("span",[t._v(t._s(a.prjid_name))])],1),t._v(" "),e("li",{staticStyle:{width:"64%"}},t._l(a.mdata,function(l,i){return e("ol",{key:i},[e("li",[e("p",[e("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.del.state,expression:"del.state"}],staticStyle:{float:"left"},attrs:{name:"model"},on:{change:function(e){return t.getModels(l,a,i,e)}},model:{value:l.models_mid,callback:function(a){t.$set(l,"models_mid",a)},expression:"item.models_mid"}}),e("span",{staticClass:"model-span",attrs:{title:t.modelData2[l.mid]}},[t._v(t._s(t.modelData2[l.mid]))])],1)]),t._v(" "),e("li",[t._v(t._s(l.leads_rate)+"%")]),t._v(" "),e("li",[t._v(t._s(l.hcallout))]),t._v(" "),e("li",[e("el-input",{model:{value:l.rank,callback:function(a){t.$set(l,"rank",a)},expression:"item.rank"}})],1)])}),0),t._v(" "),e("li",{staticStyle:{width:"22%",margin:"10px 0px","text-align":"right"}},[e("el-button",{staticClass:"btn-small",attrs:{value:""},on:{click:function(e){return t.addproj(a)}}},[t._v("添加模型")]),t._v(" "),e("el-button",{staticClass:"btn-small",attrs:{value:""},on:{click:function(e){return t.saveproj(a)}}},[t._v("保存")])],1)])})],2),t._v(" "),e("page-table",{attrs:{show_size:"true",cur:t.search.page,total_page:t.list.totalPage,total_count:t.list.totalCount},on:{change:t.change_data}})],1),t._v(" "),e("el-dialog",{attrs:{visible:t.dialog_add,title:"请从下拉菜单中选择新增模型"},on:{"update:visible":function(a){t.dialog_add=a}}},[e("div",t._l(t.addlist,function(a,l){return e("ol",[e("li",[e("el-select",{staticClass:"dialog_projselect",staticStyle:{width:"100%"},on:{change:function(e){return t.getMid(a.mid,l)}},model:{value:a.mid,callback:function(e){t.$set(a,"mid",e)},expression:"item.mid"}},[t._l(t.area,function(a,l){return[e("el-option",{key:a.id,attrs:{label:a.memo,value:a.id}},[t._v(t._s(a.memo))])]})],2)],1),t._v(" "),e("li",[t._v(t._s(a.leads_rate)+"%")]),t._v(" "),e("li",[t._v(t._s(a.hcallout))]),t._v(" "),"1"!=t.addlist.length?e("li",{staticStyle:{cursor:"pointer"},on:{click:function(a){return t.dellist(l)}}},[t._v("删除")]):t._e()])}),0),t._v(" "),e("el-button",{on:{click:t.addprojselect}},[t._v("添加品牌")]),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.dialog_add=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("li",{staticStyle:{width:"62%"}},[a("ol",[a("li",{staticStyle:{width:"400px"}},[this._v("模型名称")]),this._v(" "),a("li",[this._v("历史成功率")]),this._v(" "),a("li",[this._v("累计外呼")]),this._v(" "),a("li",[this._v("权重")])])])}]};var c=e("VU/8")(n,r,!1,function(t){e("6VjT"),e("JeKj")},"data-v-0b034d18",null);a.default=c.exports},fZjL:function(t,a,e){t.exports={default:e("jFbC"),__esModule:!0}},jFbC:function(t,a,e){e("Cdx3"),t.exports=e("FeBl").Object.keys},uqUo:function(t,a,e){var l=e("kM2E"),i=e("FeBl"),s=e("S82l");t.exports=function(t,a){var e=(i.Object||{})[t]||Object[t],o={};o[t]=a(e),l(l.S+l.F*s(function(){e(1)}),"Object",o)}}});
//# sourceMappingURL=4.94b85343897faa1ff99a.js.map